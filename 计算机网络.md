# 第一章 计算机网络体系结构

## 1.1计算机网络概述

### 1.1.4 计算机网络的分类

（1）.按交换技术分类

- 电路交换网络

- 报文交换网络

  特点：信息拆分成小包（报文），大小无限制，有目的/源等信息，提高了利用率；

  ==需要等所有小包都到达后才能转发==

- 分组交换网络（分为**虚电路**和**数据报**）

  特点：小包大小有限制，不需要等所有小包都到达后就能转发；

  缺点：附加信息开销大；

​		**虚电路**：规定路线；有连接，可靠；

​		**数据报**：不规定；无连接，不可靠；

## 1.2 计算机网络体系结构与参考模型

一、**网络分层的目的**：（注：不定义功能执行的方法）

1. 提供标准语言
2. 定义标准界面
3. 增加功能之间的独立性

**应用层**：（端到端）

1. 功能：
2. SAP：用户界面



**传输层**：（端到端）

1. 功能：

   流量控制、差错控制、服务质量、数据传输管理；

2. SAP：端口号

- 实现==端到端==的应答、进程到进程
- 提供有连接可靠的服务
- 

**网络层**：（点到点）

1. 功能：

   流量控制、差错控制、拥塞控制、网际互联；

2. SAP：IP地址

3. 设备：（主机——主机）路由器

- 提供无连接不可靠数据报服务
- 

**数据链路层**：（点到点）

1. 功能：

   寻址、成帧、差错控制、流量控制、传输管理；

2. SAP：MAC地址

3. 设备：（结点——结点）交换机、网桥、网卡

**物理层**：（点到点）

1. 功能：
2. SAP：网卡接口
3. 设备:集线器、中继器、电缆、发送器、接收器



**总结**：

![image-20220713184815875](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20220713184815875.png)

1. 应用层的小三层之间不存在数据封装的过程，整个应用层的数据传给传输层；
2. TCP/IP向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务；

协议的三要素：

- 语法：定义所交换信息的格式
- 语义：定义收发双方所要完成的操作
- 同步：定义收发双方的时序关系

数据链路层、网络层、传输层都有流量控制的功能，数据链路层是相邻结点之间的流量控制，网络层是整个网络的流量控制，传输层是端到端的流量控制；



# 第二章 物理层

## 2.1 通信基础

信号上传送的信号：

- 基带信号：数字信道（近距离传输）

- 宽带信号：模拟信道（远距离传输）

  

## 2.3 物理层设备

**集线器：**

使用集线器的以太网在逻辑上是共享总线的，需要使用CSMA/CD协议来协调各主机争用总线；只能工作在半双工模式下；



1、设备隔离考察点：

|                                      | 能否隔离冲突域 | 能否隔离广播域 |
| ------------------------------------ | :------------: | :------------: |
| 物理层设备【傻瓜】（中继器、集线器） |       ✘        |       ✘        |
| 链路层设备【路人】（网桥、交换机）   |       ✔        |       ✘        |
| 网络层设备【大佬】（路由器）         |       ✔        |       ✔        |

路由器默认情况下不对广播数据进行转发，因此可以隔离广播域；



# 第三章 数据链路层

### 1.协议：

停止-等待协议

后退N帧协议

选择重传协议

令牌传递协议



## 3.3 差错控制

**海明码：**

确定海明码的位数：

设n为有效信息的位数，k为校验位的位数，则信息位n和校验位k应满足

$$n+k<=2^k-1$$ （若要检测两位错，则需要再增加1位校验位，即k+1位）



![image-20221110172814360](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221110172814360.png)

- 检测 d bit错误，海明码距为：d+1；
- 纠正 d bit错误，海明码距为：2d+1；



### 3.3.3 习题知识点

1. 数据的传输差错是由噪声引起的；

   通信信道的噪声可分为两类：

   - 热噪声：信道固有的，引起的差错是**随机差错**，可通过**提高信噪比**来降低数据传输的影响；
   - 冲击噪声：外界电磁干扰引起的，引起的差错是**突发差错**，它是引起传输差错的主要原因，无法通过提高信噪比来避免；

## 3.4 流量控制与可靠传输机制

在连续 ARQ 协议中，发送窗口的大小<=窗口总数-1；



## 3.5 介质访问控制

### 3.5.4 习题知识点

1. **集线器（Hub）**：在OSI模型中属于数据链路层。价格便宜是它最大的优势，但由于集线器属于共享型设备，导致了在繁重的网络中，效率变得十分低下，所以我们在中、大型的网络中看不到集线器的身影。如今的集线器普遍采用全双工模式，市场上常见的集线器传输速率普遍都为100Mbps；
2. 对于10Mb/s的以太网，在争用期内可发送512bit，即64B；不考虑以太网帧的前导码，以太网帧最小为64B；



## 3.6 局域网

局域网采用广播信道；

**IEEE标准**：

IEEE 802.3：以太网

IEEE 802.5：令牌环网

IEEE 802.8：光纤技术

IEEE 802.11：无线局域网

### 3.6.2 以太网与IEEE 802.3

MAC地址又称为物理地址或硬件地址；

使用集线器的以太网在逻辑上仍是一个总线网，各站共享逻辑上的总线，使用的还是CSMA/CD协议；

以太网拓扑：逻辑上总线型，物理上星型；

### 3.6.3 IEEE 802.11无线局域网

**802.11局域网的MAC帧首部**

![image-20221004201149328](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221004201149328.png)







![image-20221030114425631](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221030114425631.png)



### 3.6.4 VLAN基本概念与基本原理

TCP/IP协议栈中很多协议都会使用**广播**：

- 地址解析协议ARP（已知IP地址，找到其对应的MAC地址）；
- 路由信息协议RIP（一种小型的内部路由协议）；
- 动态主机配置协议DHCP（用于自动配置IP地址）；



### 3.6.5 知识点补充

1. 网卡实现的主要功能是在物理层和数据链路层；
2. 以太网地址就是通常所说的MAC地址；
3. 通过域名解析得到的是IP地址；
4. 在以太网中，大量的广播信息会降低整个网络性能的原因是：网络中的每台计算机都必须处理每个广播信息。判断收到的广播信息的目的地址是不是自己；
5. 同一个局域网中，不能有两个相同的MAC地址，否则会导致两个设备都不能正常通信；
6. IEEE 802 局域网标准对应OSI参考模型的物理层和数据链路层；
7. 虚拟局域网通过**软件**方式实现逻辑分组与管理；
8. 划分VLAN的方法：
   - 基于交换机端口
   - 基于MAC地址（网卡地址）
   - 基于IP地址（网络层地址）
9. 1



## 3.7 广域网

1. 广域网的通信子网主要使用**分组交换**技术，将分布在不同地区的局域网或计算机系统互联起来，达到资源共享的目的；

   

## 3.8 数据链路层设备

以太网交换机进行转发决策时使用的PDU地址是**目的物理地址**；





# 第四章 网络层

### 1.协议

IP协议

ARP

DHCP（应用层协议）

ICMP

RIP

OSPF

BGP

IGMP

## 4.1 网络层的功能

1. 在路由器互联的多个局域网的结构中，要求每个局域网**物理层、数据链路层、网络层协议可以不同，而网络层以上的高层协议必须相同**；
2. 在因特网中，一个路由器的路由表通常包含**目的网络和到达该网络路径上的下一个路由器的IP地址**；、



默认网关：与主机相连的路由器的对应端口的IP地址；



## 4.2 路由算法

![image-20220724171833822](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20220724171833822.png)



IP分组交付方式：（判断依据：**子网地址是否相同**）：

![image-20221007181235998](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221007181235998.png)



1. 直接交付：目的IP & 发送口掩码 = 源IP & 发送口掩码    目的IP地址——物理地址

2. 间接交付：目的IP & 发送口掩码 ≠ 源IP & 发送口掩码    下一跳IP地址——物理地址（如ARP协议）

在上图中，A与B在同一物理网段内，所以A将数据转发给B为直接交付，不涉及路由器；



## 4.3 IPv4

### 4.3.4 IPv4地址与NAT

私有IP地址网段如下：

A类：1个A类网段：**10**.0.0.0~**10**.255.255.255

B类：16个B类网段：**172.16**.0.0~**172.31**.255.255

C类：255个C类网段：**192.168.0**.0~**192.168.255**.255

NAT：**在因特网中的所有路由器，对目的地址是私有地址的数据报一律不进行转发；**



### 4.3.4 ARP、DHCP与ICMP

**地址解析协议（ARP）（网络层）**：将IP地址解析为MAC地址；

ARP的使用是逐段链路进行的，不能跨网络进行；



**动态主机配置协议（DHCP）**（应用层）

动态主机配置协议（DHCP）是**应用层**协议，使用**客户/服务器**方式，客户端和服务器端通过**广播**方式进行交互，基于**UDP**；



1、在不考虑NAT情况下，源/目的IP地址不会改变；只要数据经过了路由器，源/目的MAC地址就会改变；
2、在考虑NAT情况下，源/目的内网IP地址不会改变，源/目的MAC地址会改变；
3、把IP网络划分成子网，这样做的好处是减小广播域的大小；（网络的数量整体是不变的，要看大网络）
4、只能作为IP分组的源IP地址但不能作为目的IP地址的是 **0.0.0.0**；
5、在传输层中，客户/服务器模式中，使用的是UDP协议；



**网际控制报文协议（ICMP）**（）

ICMP为IP层数据；



## 4.4 IPv6

1. IPv6将地址从32位（4B）扩大到128位（16B），更大的地址空间；
2. IPv6将IPv4的校验和字段彻底移除，以减少每跳的处理时间；
3. IPv6将IPv4的可选字段移出首部，变成了**扩展首部**，成为灵活的首部格式，路由器通常不对扩展首部进行检查，大大提高了路由器的处理效率；
4. IPv6支持即插即用（即自动配置），不需要DHCP协议。
5. IPv6首部长度必须是8B的整数倍，IPv4首部是4B的整数倍。
6. IPv6只能在主机处分片，IPv4可以在路由器和主机处分片。



## 4.5 路由协议

1. 路由选择时，负责发现下一条的物理地址的是**ARP**；
2. 路由收敛：当路由环境发生变化时，各路由器调整自己的路由表以适应网络拓扑结构的变化，最终达到稳定状态（路由表与网络拓扑结构状态保持一致）
3. RIP路由器不知道全网的拓扑结构，OSPF协议的任何一个路由器都知道自己所在区域的拓扑结构；
4. 



## 4.6 IP组播



## 4.8 网络层设备

1. 路由器是第三层设备，要处理的内容比第二层设备交换机多，因而转发速度比交换机慢；
2. 通常的路由器可以支持多种网络层协议，并提供不同协议之间的分组转发；
3. 路由器根据IP地址进行转发，交换机根据MAC地址进行转发；
4. 网络层向上只提供简单灵活的无连接的，尽最大努力交付的数据报服务；
5. 



# 第五章 传输层

### 1.协议：

TCP

UDP



**UDP和TCP对比：**

![image-20221109083300161](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221109083300161.png)

UDP是面向报文的，TCP是面向字节流的；

UDP支持一对一，一对多，多对一，多对多（单波，多播，广播）交互通信，TCP只支持一对一通信（三次握手，四次挥手建立单独的通道）；





## 5.1 传输层提供的服务

1. 通信子网包括物理层、数据链路层和网络层，主要负责数据通信；资源子网是OSI参考模型的上三层，传输层的主要任务是向高层用户屏蔽下面通信子网的细节；
2. 网络层的TCP提供的是无连接不可靠的数据报服务，运输层的TCP提供的是有连接可靠的服务；

## 5.3 

1. 为保证数据传输的可靠性，TCP采用了对**报文段**确认的机制；
2. 发送窗口的值即为当前发送端可以发送的字节数；

在TCP三次握手中，第三次握手是否多余？为什么？

不多余，这是为了防止已失效的TCP连接请求报文段突然由传送到了TCP服务器，因而导致错误；



# 第六章 应用层

### 1.协议

FTP

SMTP

POP3

HTTP



## 6.1 网络应用模型

1. 在C/S（客户/服务器）模型中，服务器也能主动发送数据给客户端，用于一些消息的通知，如一些错误的通知；



## 6.2 域名系统（DNS）

应用层协议：

![image-20221014202938035](C:\Users\24504\AppData\Roaming\Typora\typora-user-images\image-20221014202938035.png)

1. 单个DNS名称~多个IP地址/MAC地址；

   单个DNS名称~多个主机；

2. 域名在不同时间可以解析出不同的IP地址，因此可以用多台服务器来分担负载；

3. 多个域名可以指向同一台主机IP地址；

4. Internet上提供访问的主机一定要有IP地址；

5. | 应用层 | 传输层 | 网络层 | 数据链路层 | 物理层 |
   | ------ | ------ | ------ | ---------- | ------ |
   | 数据   | 数据段 | 数据报 | 数据帧     | 比特   |



## 6.4 电子邮件

SMTP只支持传输7bitASCII码内容，

## 6.5 万维网（www）

1. 从协议分析的角度，WWW服务器的第一步操作是浏览器对服务器的**请求域名解析**；
2. Cookie：某些网站为了辨别用户身份，进行跟踪而存在本地终端上的数据/文本文件（通常经过加密）；产生于web服务器，存储于客户主机；
3. 
